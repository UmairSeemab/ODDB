<!-- <?php include "logger.php"; ?>  logs every visit -->
<!DOCTYPE html>
<html lang="en">
<!-- Basic -->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<!-- Mobile Metas -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="viewport" content="initial-scale=1, maximum-scale=1">
<!-- Site Metas -->
<title>ODDB - Ocular Diseases Databa</title>
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="author" content="">
<!-- Site Icons -->
<link rel="shortcut icon" href="images/fevicon.ico.png" type="image/x-icon" />
<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
<!-- Bootstrap CSS -->
<link rel="stylesheet" href="css/bootstrap.min.css">
<!-- Site CSS -->
<link rel="stylesheet" href="style.css">
<!-- Colors CSS -->
<link rel="stylesheet" href="css/colors.css">
<!-- ALL VERSION CSS -->
<link rel="stylesheet" href="css/versions.css">
<!-- Responsive CSS -->
<link rel="stylesheet" href="css/responsive.css">
<!-- Custom CSS -->
<link rel="stylesheet" href="css/custom.css">
<!-- Modernizer for Portfolio -->
<script src="js/modernizer.js"></script>
<!-- [if lt IE 9] -->
<style>
   .button-container {
      margin-bottom: 20px;
      display: flex;
      justify-content: space-between;
   }

   .button-container#secondaryButtons {
      justify-content: flex-end;
      /* Secondary buttons align to the right */
   }

   .button {
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      border: none;
      margin-left: 10px;
      border-radius: 4px;
   }

   .button.active {
      background-color: #007BFF;
      color: white;
   }

   .iframe-container iframe {
      display: none;
      /* Hide the iframe */
      width: 100%;
      height: 900px;
      border: none;
   }

   .iframe-container iframe.active {
      display: block;
      /* Show the iframe */

   }

   td {
      padding: 1px;
   }
</style>
<style>
   table {
      border-collapse: collapse;
      width: 80%;
   }

   th,
   td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
   }

   td {
      color: #999;
   }

   th {
      background: #fff;
      color: #157fda
   }
</style>

</head>

<body class="clinic_version">
   <!-- LOADER -->
   <!--<div id="preloader">
      <img class="preloader" src="images/loaders/output-onlinegiftools.gif" alt="">
   </div>-->
   <!-- END LOADER -->
   <header>
      <div class="header-top wow fadeIn">
         <div class="container">
            <div class="row align-items-center">
               <!-- Logo -->
               <div class="col-md-4">
                  <a class="navbar-brand" href="index.html">
                     <img src="images/logoo.png" alt="image" style="width:100px;margin-top:-10px">
                  </a>
               </div>
               <!-- Navigation with custom class for padding adjustments -->
               <div class="col-md-8 text-right custom-nav">
                  <div id="navbar" class="navbar-collapse collapse">
                     <ul class="nav navbar-nav d-flex justify-content-end">
                        <li><a class="active nav-li" href="index.html">Home</a></li>
                        <li><a class="nav-li" data-scroll href="about_us.html">About us</a></li>
                        <li><a class="nav-li" data-scroll href="#Tutorial">Tutorial</a></li>
                        <!-- Dropdown Start -->
                        <li class="dropdown">
                           <a class="nav-li dropdown-toggle">Analysis</a>
                           <ul class="dropdown-menu">
                              <li><a href="Drug-based-stat.html">Drug based analysis</a></li>
                              <li><a href="Gene-based-stat.html">Gene based analysis</a></li>
                              <li><a href="MOI-stat.html">Inheritance based analysis</a></li>
                              <li><a href="Variant-based-stat.html">Variant based analysis</a></li>
                           </ul>
                        </li>
                        <!-- Dropdown End -->
                        <li class="dropdown">
                           <a class="nav-li dropdown-toggle">Statistics</a>
                           <ul class="dropdown-menu">
                              <li><a href="Drug.html">Drug based statistics</a></li>
                              <li><a href="Gene.html">Gene based statistics</a></li>
                              <li><a href="Inheritance.html">Inheritance based statistics</a></li>
                              <li><a href="Variant.html">Variant based statistics</a></li>
                           </ul>
                        </li>
                        <!-- Dropdown End -->
                        <li><a class="nav-li" data-scroll href="download.html">Download</a></li>
                        <li><a class="nav-li" data-scroll href="#getintouch">Contact Us</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </header>
   <div id="about" class="section wow fadeIn">
      <div id="getintouch" class="section wb wow fadeIn" style="padding-bottom:0;margin-top: -70px;">
         <div>
            <div class="flex coloum" style="display: none; flex-direction: row; justify-content: space-between;">
               <!--display: flex;-->
               <h1 style="display: none;">Force Network Graph</h1>
               <a style="margin: 1rem;" href="https://occular-force.vercel.app/" target="_blank" data-scroll
                  class="btn btn-light btn-radius btn-brd grd1 effect-1">Full screen view </a>
            </div>
            <div class="button-container">
               <div>
                  <button class="button active" id="button1" onclick="showIframe(1)">Anatomy Based
                     Categorization</button>
                  <button class="button" id="button2" onclick="showIframe(2)">Inheritance Based Categorization</button>
               </div>
               <div class="button-container" id="secondaryButtons" style="justify-content: flex-end;">
                  <button class="button active" id="geneButton" onclick="toggleSecondary('gene')">Gene Based</button>
                  <button class="button" id="variantButton" onclick="toggleSecondary('variant')">Variant Based</button>
               </div>
            </div>
            <div class="iframe-container">
               <iframe id="iframe1" src="https://occular-force-part-2.vercel.app/" class="iframe active"></iframe>
               <iframe id="iframe2" src="https://occular-force.vercel.app/" class="iframe"></iframe>
               <iframe id="iframe3" src="https://anatomy-part-2.vercel.app/" class="iframe"></iframe>
            </div>
            <!-- <div class="iframe-container">
        <iframe src="https://occular-force-part-2.vercel.app/" class="active" id="iframe1"  scrolling="no"></iframe>
        <iframe src="https://occular-force.vercel.app/" id="iframe2"  scrolling="no"></iframe>
        <iframe src="   https://anatomy-part-2.vercel.app/" id="iframe3"  scrolling="no"></iframe>
    </div> -->


         </div>

         <div class="container">
            <div class="heading" style="margin-top: 30px;">
               <span class="icon-logo"><img src="images/icon-logo1.jpg" alt="#"></span>
               <h2>Get in Touch</h2>
            </div>
         </div>
         <div class="contact-section">
            <div class="form-contant">
               <form id="ajax-contact" action="assets/mailer.php" method="post">
                  <div class="row">
                     <div class="col-md-6">
                        <div class="form-group in_name">
                           <input type="text" class="form-control" placeholder="Name" required="required">
                        </div>
                     </div>
                     <div class="col-md-6">
                        <div class="form-group in_email">
                           <input type="email" class="form-control" placeholder="E-mail" required="required">
                        </div>
                     </div>
                     <div class="col-md-6">
                        <div class="form-group in_email">
                           <input type="tel" class="form-control" id="phone" placeholder="Phone" required="required">
                        </div>
                     </div>
                     <div class="col-md-6">
                        <div class="form-group in_email">
                           <input type="text" class="form-control" id="subject" placeholder="Subject"
                              required="required">
                        </div>
                     </div>
                     <div class="col-md-12">
                        <div class="form-group in_message">
                           <textarea class="form-control" id="message" rows="5" placeholder="Message"
                              required="required"></textarea>
                        </div>
                        <div class="actions">
                           <input type="submit" value="Send Message" name="submit" id="submitButton" class="btn small"
                              title="Submit Your Message!">
                        </div>
                     </div>
                  </div>
               </form>
            </div>
            <div id="googleMap" style="width:100%;height:450px;"></div>
         </div>

         <footer id="footer" class="footer-area wow fadeIn">
            <div class="container">
               <div class="row">
                  <div class="col-md-4">
                     <div class="logo padding">
                        <a href=""><img src="images/logo1.png" alt=""></a>
                        <p>A database for Ocular Diseases.</p>
                     </div>
                  </div>
                  <div class="col-md-4">
                     <div class="footer-info padding">
                        <h3>CONTACT US</h3>
                        <p><i class="fa fa-map-marker" aria-hidden="true"></i> UEF, Kuopio, Finland</p>
                        <p><i class="fa fa-paper-plane" aria-hidden="true"></i> u.seemab@gmail.com</p>
                        <p><i class="fa fa-phone" aria-hidden="true"></i> (+358) 123 456</p>
                     </div>
                  </div>
                  <div class="col-md-4">
                     <div id="statsContainer">
                        <h1 style="text-align:left;font-weight:600;">
                           Visitors count: <span id="visitorCount">0</span>
                        </h1>

                        <div style="max-height:128px; overflow-y:auto; border:1px solid #ccc;">
                           <table border="1" cellspacing="0" cellpadding="8"
                              style="width:100%; text-align:center; border-collapse:collapse;">
                              <tbody id="statsTable"></tbody>
                           </table>
                        </div>
                     </div>

                     <script type="module">
                        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
                        import {
                           getFirestore,
                           collection,
                           addDoc,
                           getDocs,
                           query,
                           where
                        } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

                        const firebaseConfig = {
                           apiKey: "AIzaSyA5VIAFJB1buNlmwNbbxyEpJmQdlVH5_84",
                           authDomain: "daring-acumen-427809-i1.firebaseapp.com",
                           projectId: "daring-acumen-427809-i1",
                           storageBucket: "daring-acumen-427809-i1.firebasestorage.app",
                           messagingSenderId: "390763490659",
                           appId: "1:390763490659:web:6bb73c6ed513927cf03756",
                           measurementId: "G-XYH6N9K123"
                        };

                        const app = initializeApp(firebaseConfig);
                        const db = getFirestore(app);

                        async function logVisitor() {
                           try {
                              const res = await fetch("https://get.geojs.io/v1/ip/geo.json");
                              const data = await res.json();

                              const ip = data.ip || "Unknown IP";

                              let location = "Unknown Location";
                              if (data.city && data.country) {
                                 location = `${data.city}, ${data.country}`;
                              } else if (data.country) {
                                 location = data.country;
                              } else if (data.organization_name) {
                                 location = data.organization_name;
                              }

                              const now = new Date();

                              const visitDate = now.toLocaleDateString("en-US", {
                                 timeZone: "America/New_York"
                              });

                              const visitorsRef = collection(db, "visitors");
                              const q = query(visitorsRef, where("ip", "==", ip), where("date", "==", visitDate));
                              const existing = await getDocs(q);

                              if (!existing.empty) {
                                 console.log("IP already visited today, skipping add:", ip);
                                 renderTable();
                                 return;
                              }

                              await addDoc(visitorsRef, {
                                 ip,
                                 location,
                                 date: visitDate,
                                 time: now.toLocaleString("en-US", {
                                    timeZone: "America/New_York",
                                    year: "numeric",
                                    month: "2-digit",
                                    day: "2-digit",
                                    hour: "2-digit",
                                    minute: "2-digit",
                                    second: "2-digit",
                                    hour12: false
                                 })
                              });

                              console.log("Visitor saved to Firebase!");
                              renderTable();
                           } catch (err) {
                              console.error("Error logging visitor:", err);
                           }
                        }

                        async function renderTable() {
                           const tbody = document.getElementById("statsTable");
                           const visitorCount = document.getElementById("visitorCount");

                           tbody.innerHTML = `<tr><td colspan="2">Loading...</td></tr>`;

                           try {
                              const snapshot = await getDocs(collection(db, "visitors"));
                              let logs = snapshot.docs.map(doc => doc.data());

                              // 🔹 Convert string "time" → Date object, then sort
                              logs.sort((a, b) => {
                                 const dateA = new Date(a.time);
                                 const dateB = new Date(b.time);
                                 return dateB - dateA; // newest first
                              });

                              visitorCount.textContent = logs.length;
                              tbody.innerHTML = "";

                              if (!logs.length) {
                                 tbody.innerHTML = `<tr><td colspan="2">No visitors logged yet</td></tr>`;
                                 return;
                              }

                              // Show latest 15 visitors
                              logs.slice(0, 15).forEach(log => {
                                 const tr = document.createElement("tr");
                                 tr.innerHTML = `<td>${log.location}</td><td>${log.time}</td>`;
                                 tbody.appendChild(tr);
                              });
                           } catch (err) {
                              tbody.innerHTML = `<tr><td colspan="2">Error loading logs: ${err.message}</td></tr>`;
                           }
                        }

                        document.addEventListener("DOMContentLoaded", logVisitor);
                     </script>
                  </div>
               </div>
         </footer>
         <div class="copyright-area wow fadeIn">
            <div class="container">
               <div class="row">
                  <div class="col-md-8">
                     <div class="footer-text">
                        <p>© LRL Group. All Rights Reserved.</p>
                     </div>
                  </div>
                  <div class="col-md-4">
                     <div class="social">
                        <ul class="social-links">
                           <li><a href=""><i class="fa fa-rss"></i></a></li>
                           <li><a href=""><i class="fa fa-facebook"></i></a></li>
                           <li><a href=""><i class="fa fa-twitter"></i></a></li>
                           <li><a href=""><i class="fa fa-google-plus"></i></a></li>
                           <li><a href=""><i class="fa fa-youtube"></i></a></li>
                           <li><a href=""><i class="fa fa-pinterest"></i></a></li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div>
         </div>

         <script>
            function showIframe(iframeNumber) {
               // Get all buttons and iframes
               const button1 = document.getElementById('button1');
               const button2 = document.getElementById('button2');
               const geneButton = document.getElementById('geneButton');
               const variantButton = document.getElementById('variantButton');
               const iframe1 = document.getElementById('iframe1');
               const iframe2 = document.getElementById('iframe2');
               const iframe3 = document.getElementById('iframe3');

               const secondaryButtons = document.getElementById('secondaryButtons');

               // Toggle logic for primary buttons
               if (iframeNumber === 1) {
                  // Activate Anatomy-based categorization
                  button1.classList.add('active');
                  button2.classList.remove('active');
                  iframe1.classList.add('active');
                  iframe2.classList.remove('active');
                  iframe3.classList.remove('active');

                  iframe1.src = iframe1.src;
                  // Show secondary buttons and set Gene as default
                  secondaryButtons.style.display = 'flex';
                  geneButton.classList.add('active');
                  variantButton.classList.remove('active');
               } else if (iframeNumber === 2) {
                  // Activate Inheritance-based categorization
                  button1.classList.remove('active');
                  button2.classList.add('active');
                  iframe1.classList.remove('active');
                  iframe2.classList.add('active');
                  iframe3.classList.remove('active');

                  // Hide secondary buttons
                  secondaryButtons.style.display = 'none';
                  iframe2.src = iframe2.src;
               } else if (iframeNumber === 3) {
                  // Handle secondary button toggling (Gene/Variant)
                  geneButton.classList.remove('active');
                  variantButton.classList.add('active');

                  iframe3.src = iframe3.src;
               }
            }

            // Additional logic for Gene and Variant buttons
            function toggleSecondary(buttonType) {
               const geneButton = document.getElementById('geneButton');
               const variantButton = document.getElementById('variantButton');
               const iframe1 = document.getElementById('iframe1');
               const iframe3 = document.getElementById('iframe3');

               if (buttonType === 'gene') {
                  geneButton.classList.add('active');
                  variantButton.classList.remove('active');
                  iframe1.classList.add('active');
                  iframe3.classList.remove('active');
                  iframe1.src = iframe1.src;
               } else {
                  geneButton.classList.remove('active');
                  variantButton.classList.add('active');
                  iframe1.classList.remove('active');
                  iframe3.classList.add('active');
                  iframe3.src = iframe3.src;
               }
            }
         </script>
         <!-- end copyrights -->
         <a href="#home" data-scroll class="dmtop global-radius"><i class="fa fa-angle-up"></i></a>
         <!-- all js files -->
         <script src="js/all.js"></script>
         <!-- all plugins -->
         <script src="js/custom.js"></script>
         <!-- map -->
         <script
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCNUPWkb4Cjd7Wxo-T4uoUldFjoiUA1fJc&callback=myMap"></script>

</body>

</html>
